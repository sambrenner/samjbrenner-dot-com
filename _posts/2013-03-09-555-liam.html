---
layout: post
title: 555-LIAM
date: 2013-03-09 20:36:27.000000000 -05:00
categories:
- Redial
tags:
- Asterisk
- ITP
- Redial
status: publish
type: post
published: true

---
<p>Let me just give my old friend Liam Neeson a quick call and see what he's - oh, hello? Liam?</p>
<p>[ylwm_vimeo width="800" height="450"]61401308[/ylwm_vimeo]</p>
<p>My midterm project for Redial is entitled "555-LIAM." My computer runs a loop of that one scene that everyone knows from <a href="http://www.imdb.com/title/tt0936501/">Taken</a>, and at any time I feel like it, I can call in to have him tell me that he will find me, and he will kill me.</p>
<p><!--more--></p>
<p>How did I do this? With a very particular set of skills, of course! My first thought was to set up a live streaming media server that would broadcast a separate video and audio stream. The video stream would be picked up by any old computer and played back. The audio stream would be accessed by our ITP Asterisk server using [cci]MP3Player[/cci] and played back to any caller.</p>
<p>It didn't take much research to find out that setting up my own live streaming server would be, among other things, very expensive. I looked into using UStream or Justin.TV as a live streaming service but as far as I could tell, they don't offer a separate MP3 audio stream to accompany their video streams. So I decided to do it all locally.</p>
<p>This created a new challenge: if I were to build my streaming media server locally, I would also need Asterisk to be running locally. A bit of searching led me to <a href="http://www.asterisk.org/downloads/asterisknow">AsteriskNOW</a>, which is essentially <a href="http://www.centos.org/">CentOS</a> with Asterisk all ready to go. I installed that in a VM through <a href="https://www.virtualbox.org/">VirtualBox</a>, and a few minutes later, had this:</p>
<p><img class="alignnone size-medium wp-image-353" src="/assets/Screen-Shot-2013-03-07-at-4.33.51-PM-600x379.png" alt="Screen Shot 2013-03-07 at 4.33.51 PM" width="600" height="379" /></p>
<p>Success! The next step was to call in to confirm everything works as expected. I made an IAX softphone with <a href="http://www.zoiper.com/">Zoiper</a> (running on my Galaxy Nexus through WiFi) and after changing my VM's networking from NAT to Bridged (to give the VM its own IP on my router), I was able to call in and run a hello world program.</p>
<p>The last thing I needed to get Asterisk to do was to consume and playback an MP3 stream. Normally, this is easily handled with the [cci]MP3Player[/cci] application, however it doesn't seem to work out of the box with AsteriskNOW. Searching around led me to <a href="http://www.voip-info.org/boards/index.php?t=26257">this forum post on VOIP-Info</a> which first had me check for <a href="http://www.mpg123.de/">mpg123</a>. It didn't exist on my box, so installing and compiling that was step one. The forum post goes on to explain how you can then trick [cci]MP3Player[/cci] into playing a stream hidden as a shell script with an .MP3 extension with some very dirty, bad-feeling code. But it works!</p>
<p>The last step was to create the audio stream. This was pretty straightforward. I used <a href="http://www.rogueamoeba.com/nicecast/">Nicecast</a>, which listened to my looping video in Quicktime Player and made an MP3 stream out of it. Using the shell-script-MP3 trick from before, I got Asterisk to find that stream on my local network and play it back to the caller.</p>
<p>At this point I realized that Nicecast doesn't just make local streams; it makes publicly accessible ones as well. So I probably could have skipped all the local Asterisk business and just tried plugging my computer's IP into ITP's Asterisk server. A few firewall issues would probably have come up, so it might have been just as much effort to make work. Regardless, I was really happy to have Asterisk set up on my VM so I could go and take a peek at everything under the hood. And, of course, to add Liam Neeson to my contacts.</p>
